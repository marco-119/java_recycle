package recycle.DAO;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class InsertItems {

    // DB 연결 정보 (기존 DAO와 동일)
    private static final String DB_URL = "jdbc:mysql://223.130.155.245:3306/recycle?serverTimezone=UTC&characterEncoding=UTF-8";
    private static final String DB_ID = "remote_user";
    private static final String DB_PASSWORD = "fjf0301!";

    public static void main(String[] args) {
        // 형식: { "품목ID", "품목명", "분류ID", "배출방법설명" }
        String[][] itemsData = {
    		// [종이류 - C01]
    		{"I001", "가격표", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I002", "골판지", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I003", "광고전단지", "C01", "비닐코팅된 종이는 쓰레기 <종량제 봉투>로 배출합니다."},
            {"I004", "랩의 심", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I005", "명함", "C01", "플라스틱 합성지 등 다른 재질 포함 시 <종량제 봉투>에 배출합니다."},
            {"I006", "백과사전", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I007", "사전", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I008", "쌀포대", "C01", "<종이류> 또는 재질에 맞게 배출합니다."},
            {"I009", "서류봉투(갈색종이)", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I010", "수첩", "C01", "<종이류> 또는 재질에 맞게 배출합니다."},
            {"I011", "신문지", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I012", "잡지", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I013", "전단지", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I014", "전화번호부", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I015", "종이상자", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I016", "종이심", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I017", "종이조각", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I018", "책", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I019", "치킨박스", "C01", "기름에 오염된 내부 종이는 <종량제봉투>로 배출합니다."},
            {"I020", "탁상달력", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I021", "포스터, 포장지", "C01", "<종이류> 배출방법을 준수하여 배출합니다."},
            {"I022", "피자박스", "C01", "기름에 오염된 내부 종이는 <종량제봉투>로 배출합니다."},
            
            // [비닐 - C02]
            {"I023", "비닐봉지(일회용)", "C02", "<비닐류> 배출방법을 준수하여 배출합니다."},
            {"I024", "아이스팩", "C02", "(일반 아이스팩) 고흡수성수지(Gel 형태)가 포함된 재활용이 어려운 폐기물로서 쓰레기 <종량제봉투>로 배출합니다.\n\n" 
            + "(물 아이스팩) 아이스팩을 뜯어 내용물을 비우고, 겉의 비닐을 깨끗하게 배출하면 재활용이 가능합니다.\n\n"
            + "※아이스팩 겉면에 고흡수성수지 포함 여부 표기"},
            {"I025", "완충재(뽁뽁이)", "C02", "<비닐류> 배출방법을 준수하여 배출합니다."},
            
            // [유리병 - C03]
            {"I026", "유리병", "C03", "<유리병류> 배출방법을 준수하여 배출합니다."},
            
            // [종이팩 - C04]
            {"I027", "우유팩(일반팩)", "C04", "<종이팩류> 배출방법을 준수하여 배출합니다."},
            {"I028", "두유팩(멸균팩)", "C04", "<종이팩류> 종이(폐지)와 구별하여 배출합니다."},
            
            // [캔/고철 - C05]
            {"I029", "스프레이", "C05", "<금속캔(부탄가스통)> 배출방법을 준수하여 배출합니다."},
            {"I030", "부탄가스", "C05", "<금속캔(부탄가스통)> 배출방법을 준수하여 배출합니다."},
            {"I031", "애완동물 음식캔", "C05", "<금속캔> 배출방법을 준수하여 배출합니다."},
            {"I032", "공구류(철)", "C05", "다른 재질이 많이 섞인 제품은 분리해서 배출하며, 분리가 어렵다면 쓰레기 <종량제봉투>로 배출합니다."},
            {"I033", "국자(고철)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I034", "그릇(고철)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I035", "나사(못)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I036", "낫", "C05", "<고철>로 배출하되, 가능하다면 손잡이 부분(나무재질 등)을 분리하여 배출합니다."},
            {"I037", "도끼", "C05", "<고철>로 배출하되, 가능하다면 손잡이 부분(나무재질 등)을 분리하여 배출합니다."},
            {"I038", "맥주병뚜껑(철, 알루미늄)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I039", "못", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I040", "분유 깡통", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I041", "쓰레기받기(고철)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I042", "아령", "C05", "<고철류> 또는 재질에 맞게 배출합니다."},
            {"I043", "압력솥", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I044", "역기", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I045", "옷걸이(세탁소 흰색 철사)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I046", "유리병 뚜껑(철, 알루미늄)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I047", "의류건조대", "C05", "<고철류>, <플라스틱류> 등 재질에 맞게 배출합니다."},
            {"I048", "재떨이(금속)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I049", "주전자(철, 알루미늄)", "C05", "플라스틱 뚜껑 등은 돌려서 제거한 후 배출합니다."},
            {"I050", "철사", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I051", "철판(가정요리용)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I052", "캔 따개", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I053", "컵(고철)", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I054", "톱", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            {"I055", "후라이팬", "C05", "<고철> 배출방법을 준수하여 배출합니다."},
            
            // [스티로폼 - C06]
            {"I056", "컵라면(스티로폼)", "C06", "<스티로폼> 배출방법을 준수하여 배출합니다."},
            {"I057", "스티로폼 상자", "C06", "<스티로폼> 배출방법을 준수하여 배출합니다."},
            
            // [플라스틱 - C07]
            {"I058", "국자(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I059", "그릇(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I060", "도마(플라스틱 도마)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I061", "리코더(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I062", "마요네즈 용기", "C07", "내부를 헹구고 플라스틱 또는 재질에 맞는 분리수거함으로 배출합니다."},
            {"I063", "메가폰(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I064", "빨대", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I065", "볼풀공", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I066", "분무기(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I067", "비디오테이프", "C07", "내부필름은 분리하여 쓰레기 <종량제봉투>로 배출합니다."},
            {"I068", "샴푸용기", "C07", "내부를 헹구고 배출합니다."},
            {"I069", "쓰레받기(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I070", "식용유용기(플라스틱)", "C07", "모두 사용 후 배출합니다."},
            {"I071", "젖병(아기용품)", "C07", "젖병의 몸체와 윗부분의 젖꼭지는 분리하여 재질에 맞게 배출합니다."},
            {"I072", "치약용기", "C07", "<플라스틱류> 또는 재질에 맞게 배출합니다."},
            {"I073", "캡(플라스틱 뚜껑)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I074", "컵(플라스틱)", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},
            {"I075", "케찹용기", "C07", "내부를 헹구고 플라스틱 또는 재질에 맞는 분리수거함으로 배출합니다."},
            {"I076", "페트병", "C07", "<플라스틱류> 배출방법을 준수하여 배출합니다."},

            // [기타 - C08]
            {"I077", "농약용기", "C08", "내용물을 다 사용한 후 따로 봉투에 담아 배출합니다."}
            
        };

        Connection conn = null;
        PreparedStatement pstmt = null;

        try {
            // DB 연결
            Class.forName("com.mysql.cj.jdbc.Driver");
            conn = DriverManager.getConnection(DB_URL, DB_ID, DB_PASSWORD);
            
            String sql = "INSERT INTO ITEMS (ITEM_ID, ITEM_NAME, CATEGORY_ID, DISPOSAL_GUIDE) VALUES (?, ?, ?, ?)";
            pstmt = conn.prepareStatement(sql);

            int count = 0;

            // 반복문으로 데이터 하나씩 집어넣기
            System.out.println("데이터 추가 시작...");
            
            for (String[] item : itemsData) {
                // 배열에서 값 꺼내서 세팅
                pstmt.setString(1, item[0]); // ITEM_ID(품목ID)
                pstmt.setString(2, item[1]); // ITEM_NAME(품목명)
                pstmt.setString(3, item[2]); // CATEGORY_ID(분류ID)
                pstmt.setString(4, item[3]); // DISPOSAL_GUIDE(배출방법설명)

                // 실행 (에러 발생 시 catch로 이동)
                pstmt.executeUpdate();
                
                count++;
                System.out.println("추가됨: " + item[1]);
            }
            
            System.out.println("--------------------------------");
            System.out.println("총 " + count + "개의 품목이 DB에 저장되었습니다");

        } catch (java.sql.SQLIntegrityConstraintViolationException e) {
            System.out.println("중복된 데이터가 있거나, 분류ID가 없습니다.");
            System.out.println("오류 내용: " + e.getMessage());
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            // 자원 해제
            try {
                if (pstmt != null) pstmt.close();
                if (conn != null) conn.close();
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }
    }
}